{"version":3,"sources":["../src/utils/ImmutableSet.ts"],"sourcesContent":["const internalSetSymbol = Symbol('#internalSet');\n\n/**\n * @public\n *\n * Small immutable wrapper around the native Set implementation.\n * Every operation that would modify the set returns a new copy instance.\n */\nexport class ImmutableSet<T> implements Iterable<T> {\n  public static empty: ImmutableSet<never> = new ImmutableSet(new Set());\n  public readonly size: number;\n\n  private [internalSetSymbol]: Set<T>;\n\n  public static dangerouslyGetInternalSet<Value>(set: ImmutableSet<Value>): Set<Value> {\n    return set[internalSetSymbol];\n  }\n\n  public static copy<T>(immutableSet: ImmutableSet<T>): ImmutableSet<T> {\n    return new ImmutableSet(new Set(immutableSet[internalSetSymbol]));\n  }\n\n  /**\n   * Creates a new {@link ImmutableSet} from an iterable.\n   * If the iterable is undefined, {@link ImmutableSet.empty} will be returned.\n   * If the iterable is already an {@link ImmutableSet}, it will be returned as is no copy will be made.\n   */\n  public static from<Value>(iterable?: Iterable<Value>): ImmutableSet<Value> {\n    if (iterable === undefined) {\n      return this.empty;\n    }\n    if (iterable instanceof this) {\n      return iterable;\n    }\n    return new this(new Set(iterable));\n  }\n\n  public static [Symbol.hasInstance](instance: unknown): boolean {\n    return Boolean(typeof instance === 'object' && instance && internalSetSymbol in instance);\n  }\n\n  /**\n   * Do not use this constructor directly, use {@link ImmutableSet.from} instead.\n   * {@link ImmutableSet.from} handles instance verification (which might be problematic on {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/instanceof#instanceof_and_multiple_realms | multiple realms}),\n   * avoid unnecessary copies, supports iterables and ensures that the internal set is never exposed.\n   *\n   *⚠️⚠️  _By using this constructor directly, you might end up with a mutable set, as it is not guaranteed that the internal set is not exposed._ ⚠️⚠️\n   */\n  constructor(internalSet: Set<T>) {\n    this[internalSetSymbol] = internalSet;\n    this.size = this[internalSetSymbol].size;\n  }\n\n  public add(value: T): ImmutableSet<T> {\n    if (this.has(value)) {\n      return this;\n    }\n    const copy = ImmutableSet.copy(this);\n    copy[internalSetSymbol].add(value);\n    return copy;\n  }\n\n  public delete(value: T): ImmutableSet<T> {\n    if (!this.has(value)) {\n      return this;\n    }\n    const copy = ImmutableSet.copy(this);\n    copy[internalSetSymbol].delete(value);\n    return copy;\n  }\n\n  public has(value: T): boolean {\n    return this[internalSetSymbol].has(value);\n  }\n\n  public [Symbol.iterator](): Iterator<T> {\n    return this[internalSetSymbol].values();\n  }\n}\n"],"names":["internalSetSymbol","Symbol","ImmutableSet","dangerouslyGetInternalSet","set","copy","immutableSet","Set","from","iterable","undefined","empty","hasInstance","instance","Boolean","add","value","has","delete","iterator","values","constructor","internalSet","size"],"mappings":";;;;+BAQaE;;;;;;;AARb,MAAMF,oBAAoBC,OAAO;IAYtBD,qBAAAA;AAJJ;IAML,OAAcG,0BAAiCC,GAAwB,EAAc;QACnF,OAAOA,GAAG,CAACJ,kBAAkB;IAC/B;IAEA,OAAcK,KAAQC,YAA6B,EAAmB;QACpE,OAAO,IAAIJ,aAAa,IAAIK,IAAID,YAAY,CAACN,kBAAkB;IACjE;IAEA;;;;GAIC,GACD,OAAcQ,KAAYC,QAA0B,EAAuB;QACzE,IAAIA,aAAaC,WAAW;YAC1B,OAAO,IAAI,CAACC,KAAK;QACnB;QACA,IAAIF,oBAAoB,IAAI,EAAE;YAC5B,OAAOA;QACT;QACA,OAAO,IAAI,IAAI,CAAC,IAAIF,IAAIE;IAC1B;IAEA,OAAc,CAACR,OAAOW,WAAW,CAAC,CAACC,QAAiB,EAAW;QAC7D,OAAOC,QAAQ,OAAOD,aAAa,YAAYA,YAAYb,qBAAqBa;IAClF;IAcOE,IAAIC,KAAQ,EAAmB;QACpC,IAAI,IAAI,CAACC,GAAG,CAACD,QAAQ;YACnB,OAAO,IAAI;QACb;QACA,MAAMX,OAAOH,aAAaG,IAAI,CAAC,IAAI;QACnCA,IAAI,CAACL,kBAAkB,CAACe,GAAG,CAACC;QAC5B,OAAOX;IACT;IAEOa,OAAOF,KAAQ,EAAmB;QACvC,IAAI,CAAC,IAAI,CAACC,GAAG,CAACD,QAAQ;YACpB,OAAO,IAAI;QACb;QACA,MAAMX,OAAOH,aAAaG,IAAI,CAAC,IAAI;QACnCA,IAAI,CAACL,kBAAkB,CAACkB,MAAM,CAACF;QAC/B,OAAOX;IACT;IAEOY,IAAID,KAAQ,EAAW;QAC5B,OAAO,IAAI,CAAChB,kBAAkB,CAACiB,GAAG,CAACD;IACrC;IAEO,CAACf,OAAOkB,QAAQ,CAAC,GAAgB;QACtC,OAAO,IAAI,CAACnB,kBAAkB,CAACoB,MAAM;IACvC;IApCA;;;;;;GAMC,GACDC,YAAYC,WAAmB,CAAE;YAtCjC,kBAAA,EAAA,IAAA,EAAgBC,QAAhB,KAAA;YAEA,kBAAA,EAAA,IAAA,EAASvB,oBAAT,KAAA;QAqCE,IAAI,CAACA,kBAAkB,GAAGsB;QAC1B,IAAI,CAACC,IAAI,GAAG,IAAI,CAACvB,kBAAkB,CAACuB,IAAI;IAC1C;AA2BF;IArEE,kBAAA,EADWrB,cACGS,SAA6B,IAAIT,aAAa,IAAIK"}