{"version":3,"sources":["../src/utils/useValidateNesting.ts"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport { useFluent_unstable as useFluent } from '@fluentui/react-shared-contexts';\n\nimport type { MenuContextValue } from '../contexts/menuContext';\nimport { useMenuContext_unstable } from '../contexts/menuContext';\n\ntype NestingComponentName = 'MenuList' | 'MenuItem' | 'MenuItemCheckbox' | 'MenuItemRadio';\n\nexport const useValidateNesting = (componentName: NestingComponentName): React.RefObject<HTMLElement | null> => {\n  'use no memo';\n\n  const { targetDocument } = useFluent();\n  const triggerRef = useMenuContext_unstable((context: MenuContextValue) => context.triggerRef);\n  const inline = useMenuContext_unstable((context: MenuContextValue) => context.inline);\n  const ref = React.useRef<HTMLElement | null>(null);\n\n  if (process.env.NODE_ENV !== 'production') {\n    // This check should run only in development mode\n    // It's okay to disable the ESLint rule because we ar checking env variable statically (not at runtime)\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    React.useEffect(() => {\n      let ancestor = ref.current;\n      let ancestorComponentName = '';\n      do {\n        ancestor = ancestor?.parentElement ?? null;\n        if (ancestor?.classList.contains('fui-MenuList')) {\n          break;\n        } else if (ancestor?.classList.contains('fui-MenuGrid')) {\n          ancestorComponentName = 'MenuGrid';\n        } else if (ancestor?.classList.contains('fui-MenuGridItem')) {\n          ancestorComponentName = 'MenuGridItem';\n        } else if (ancestor?.classList.contains('fui-MenuGridRow')) {\n          ancestorComponentName = 'MenuGridRow';\n        } else if (ancestor?.classList.contains('fui-MenuGridCell')) {\n          ancestorComponentName = 'MenuGridCell';\n        }\n        if (['MenuItem', 'MenuItemCheckbox', 'MenuItemRadio'].includes(componentName)) {\n          if (['MenuGrid', 'MenuGridItem', 'MenuGridRow', 'MenuGridCell'].includes(ancestorComponentName)) {\n            throw new Error(\n              `${componentName} is incorrectly nested within ${ancestorComponentName}. You probably want to wrap it in a MenuList instead.`,\n            );\n          }\n        } else if (componentName === 'MenuList') {\n          if (ancestorComponentName === 'MenuGridCell') {\n            if (inline && getCellOfTrigger(triggerRef.current, targetDocument) === ancestor) {\n              break;\n            }\n            throw new Error(`MenuList is incorrectly nested within MenuGridCell.`);\n          } else if (['MenuGrid', 'MenuGridItem', 'MenuGridRow'].includes(ancestorComponentName)) {\n            throw new Error(`MenuList is incorrectly nested within ${ancestorComponentName}.`);\n          }\n        }\n      } while (ancestor && ancestor !== targetDocument?.body);\n    }, [componentName, ref, triggerRef, inline, targetDocument]);\n  }\n  return ref;\n};\n\nconst getCellOfTrigger = (trigger: HTMLElement | null, targetDocument?: Document): HTMLElement | null => {\n  let ancestor = trigger?.parentElement;\n  while (ancestor && ancestor !== targetDocument?.body) {\n    if (ancestor?.classList.contains('fui-MenuGridCell')) {\n      return ancestor;\n    }\n    ancestor = ancestor?.parentElement ?? null;\n  }\n  return null;\n};\n"],"names":["React","useFluent_unstable","useFluent","useMenuContext_unstable","useValidateNesting","componentName","targetDocument","triggerRef","context","inline","ref","useRef","process","env","NODE_ENV","useEffect","ancestor","current","ancestorComponentName","parentElement","classList","contains","includes","Error","getCellOfTrigger","body","trigger"],"mappings":"AAAA;AAEA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,sBAAsBC,SAAS,QAAQ,kCAAkC;AAGlF,SAASC,uBAAuB,QAAQ,0BAA0B;AAIlE,OAAO,MAAMC,qBAAqB,CAACC;IACjC;IAEA,MAAM,EAAEC,cAAc,EAAE,GAAGJ;IAC3B,MAAMK,aAAaJ,wBAAwB,CAACK,UAA8BA,QAAQD,UAAU;IAC5F,MAAME,SAASN,wBAAwB,CAACK,UAA8BA,QAAQC,MAAM;IACpF,MAAMC,MAAMV,MAAMW,MAAM,CAAqB;IAE7C,IAAIC,QAAQC,GAAG,CAACC,QAAQ,KAAK,cAAc;QACzC,iDAAiD;QACjD,uGAAuG;QACvG,sDAAsD;QACtDd,MAAMe,SAAS,CAAC;YACd,IAAIC,WAAWN,IAAIO,OAAO;YAC1B,IAAIC,wBAAwB;YAC5B,GAAG;oBACUF;gBAAXA,WAAWA,CAAAA,0BAAAA,qBAAAA,+BAAAA,SAAUG,aAAa,cAAvBH,qCAAAA,0BAA2B;gBACtC,IAAIA,qBAAAA,+BAAAA,SAAUI,SAAS,CAACC,QAAQ,CAAC,iBAAiB;oBAChD;gBACF,OAAO,IAAIL,qBAAAA,+BAAAA,SAAUI,SAAS,CAACC,QAAQ,CAAC,iBAAiB;oBACvDH,wBAAwB;gBAC1B,OAAO,IAAIF,qBAAAA,+BAAAA,SAAUI,SAAS,CAACC,QAAQ,CAAC,qBAAqB;oBAC3DH,wBAAwB;gBAC1B,OAAO,IAAIF,qBAAAA,+BAAAA,SAAUI,SAAS,CAACC,QAAQ,CAAC,oBAAoB;oBAC1DH,wBAAwB;gBAC1B,OAAO,IAAIF,qBAAAA,+BAAAA,SAAUI,SAAS,CAACC,QAAQ,CAAC,qBAAqB;oBAC3DH,wBAAwB;gBAC1B;gBACA,IAAI;oBAAC;oBAAY;oBAAoB;iBAAgB,CAACI,QAAQ,CAACjB,gBAAgB;oBAC7E,IAAI;wBAAC;wBAAY;wBAAgB;wBAAe;qBAAe,CAACiB,QAAQ,CAACJ,wBAAwB;wBAC/F,MAAM,IAAIK,MACR,GAAGlB,cAAc,8BAA8B,EAAEa,sBAAsB,qDAAqD,CAAC;oBAEjI;gBACF,OAAO,IAAIb,kBAAkB,YAAY;oBACvC,IAAIa,0BAA0B,gBAAgB;wBAC5C,IAAIT,UAAUe,iBAAiBjB,WAAWU,OAAO,EAAEX,oBAAoBU,UAAU;4BAC/E;wBACF;wBACA,MAAM,IAAIO,MAAM,CAAC,mDAAmD,CAAC;oBACvE,OAAO,IAAI;wBAAC;wBAAY;wBAAgB;qBAAc,CAACD,QAAQ,CAACJ,wBAAwB;wBACtF,MAAM,IAAIK,MAAM,CAAC,sCAAsC,EAAEL,sBAAsB,CAAC,CAAC;oBACnF;gBACF;YACF,QAASF,YAAYA,cAAaV,2BAAAA,qCAAAA,eAAgBmB,IAAI,EAAE;QAC1D,GAAG;YAACpB;YAAeK;YAAKH;YAAYE;YAAQH;SAAe;IAC7D;IACA,OAAOI;AACT,EAAE;AAEF,MAAMc,mBAAmB,CAACE,SAA6BpB;IACrD,IAAIU,WAAWU,oBAAAA,8BAAAA,QAASP,aAAa;IACrC,MAAOH,YAAYA,cAAaV,2BAAAA,qCAAAA,eAAgBmB,IAAI,EAAE;QACpD,IAAIT,qBAAAA,+BAAAA,SAAUI,SAAS,CAACC,QAAQ,CAAC,qBAAqB;YACpD,OAAOL;QACT;YACWA;QAAXA,WAAWA,CAAAA,0BAAAA,qBAAAA,+BAAAA,SAAUG,aAAa,cAAvBH,qCAAAA,0BAA2B;IACxC;IACA,OAAO;AACT"}